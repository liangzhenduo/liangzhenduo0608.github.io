<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8" name="theme-color" content="#171714">
  
  <meta name="google-site-verification" content="fTlRYC4_eug8Q64ZK4Lzdv8mcunvs7S0Ec-39TBokv4">
  
  <!-- Google Analytics -->
  <script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-132384849-1', 'auto');
	ga('send', 'pageview');
  </script>
  <!-- End Google Analytics -->

  <!-- Google AdSense -->
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-9920928489161252",
      enable_page_level_ads: true
    });
  </script>
  <!-- End Google AdSense -->

  
  <link rel="alternative" href="/atom.xml" title="Shintaku&#39;s Blog" type="application/atom+xml">
  
  <link rel="manifest" href="manifest.json">
  
  <link rel="shortcut icon" href="/images/icon.png">
  
  
  <title>Shintaku&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Shintaku&#39;s Blog">
<meta property="og:url" content="https://liangzhenduo0608.github.io/page/2/index.html">
<meta property="og:site_name" content="Shintaku&#39;s Blog">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Shintaku&#39;s Blog">
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-3.3.1.min.js"></script>
  <script src="/js/nprogress.js"></script>
  <link href="/css/nprogress.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Shintaku&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">いいこと？暁の水平線に勝利を刻みなさい！</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=fa-home title='Home'></i> Home</a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=fa-user title='About'></i> About</a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=fa-archive title='Archives'></i> Archives</a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=fa-tags title='Tags'></i> Tags</a>
          
        
          
            <a class="main-nav-link" href="/gallery"><i class=fa-camera title='Gallery'></i> Gallery</a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://liangzhenduo0608.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          <section id="main" class='pjax'>
  
    <article id="post-deepwalk" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
<a href="/posts/deepwalk/" class="article-date">
  <time datetime="2017-03-28T07:15:15.000Z" itemprop="datePublished">2017-03-28</time>
</a>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/机器学习/">机器学习</a>►<a class="article-category-link" href="/categories/机器学习/论文/">论文</a>
  </div>

  </div>
  <div class="article-inner">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/img/deepwalkbanner.png" rel="gallery_ck4p7xq12000g3ph8g79j0x3d">
        <img src="/img/deepwalkbanner.png" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/deepwalk/">DeepWalk：社会表征的在线学习</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="https://liangzhenduo0608.github.io/posts/deepwalk/" data-id="ck4p7xq12000g3ph8g79j0x3d" class="article-share-link">Share</a>
      
        <a href="https://liangzhenduo0608.github.io/posts/deepwalk/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/机器学习/">机器学习</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <blockquote>
<p>原文：<a href="https://arxiv.org/pdf/1403.6652.pdf" target="_blank" rel="noopener">DeepWalk: Online Learning of Social Representations</a><br>源码：<a href="https://github.com/phanein/deepwalk" target="_blank" rel="noopener">phanein/deepwalk</a></p>
</blockquote>
<h1 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h1><p><strong>DeepWalk</strong>是一种学习网络中节点的隐式表征的新颖方法。这些隐式表征把社会关系编码到统计模型易于使用的连续的向量空间中。DeepWalk使用从删减的<a href="https://zh.wikipedia.org/wiki/%E9%9A%A8%E6%A9%9F%E6%BC%AB%E6%AD%A5" target="_blank" rel="noopener">随机游走</a>获得的局部信息，通过游走等价句子学习出隐式表征。DeepWalk还是可扩张的，它是一个构建增量结果的在线学习算法，并且是并行的。这些特性使其广泛适用于实际应用，如网络分类或异常检测。</p>
<h1 id="问题定义"><a href="#问题定义" class="headerlink" title="问题定义"></a>问题定义</h1><p>考虑将社会网络成员分成若干类，令\(G=(V, E)\)，其中\(V\)代表网络中的成员，\(E\)代表它们的连接，\(E\in(V\times V)\)且\(G_L=(V, E, X, Y)\)是部分标注的社会网络，满足\(X\in\mathbb{R}^{|V|\times S}\)，\(S\)是每个特征向量空间的大小，\(Y\in\mathbb{R}^{|V|\times |\mathcal{Y}|}\)，\(\mathcal{Y}\)是标签集。<br>在传统机器学习分类环境中，目标是学习一个从\(X\)的元素到标签集\(\mathcal{Y}\)的假定映射\(H\)。在这种情况下，可以利用有关嵌入到结构\(G\)的实例依赖的重要信息来取得较好的效果。<br>本文提出一种捕获网络拓扑信息的方法，在不把标签空间作为特征空间的一部分的情况下，使用无监督方法学习独立于标签分布的图结构特征。这种将结构表征和标签任务的分离避免了发生在迭代方法上的级联错误。此外相同的表征还可以用于考虑网络的多分类问题。<br>本文目标是学习\(X_E\in\mathbb{R}^{|V|\times d}\)，其中\(d\)是潜在的维数。这些低维表示是分散的，表示每个社会现象在维度子集的压缩，并且每个维度贡献一个在空间上压缩的社会概念的子集。使用这些结构特征将增加属性空间来帮助确定分类。这些特征是普遍的，并可以用于任何分类算法（包括迭代法）。</p>
<h1 id="学习社会表征"><a href="#学习社会表征" class="headerlink" title="学习社会表征"></a>学习社会表征</h1><p>尝试根据以下特点学习社会表征：</p>
<ul>
<li><strong>普适性</strong>：真实社会网络是不断进化的，新的社会关系不需要再次重复学习过程。</li>
<li><strong>团体性</strong>：隐式维度间的距离应当表示网络中相关成员的社会相似性。这样可以在网络中实现普遍化。</li>
<li><strong>低维性</strong>：当标记数据很少时用低维模型能更好地概括、加快收敛和推断。</li>
<li><strong>连续性</strong>：需要隐式表征在连续空间上建模部分社团关系。为了发现社团关系的细微差别，连续表征有健壮的社团间的平滑边界。</li>
</ul>
<h2 id="随机游走"><a href="#随机游走" class="headerlink" title="随机游走"></a>随机游走</h2><p>把以节点\(v_i\)为起点的随机游走记作\(\mathcal{W}_{v_i}\)。随机游走是一个由随机变量\(\mathcal{W}_{v_i}^1,\mathcal{W}_{v_i}^2,\ldots,\mathcal{W}_{v_i}^k\)决定的随机过程，使得\(\mathcal{W}_{v_i}^{k+1}\)是从节点\(v_k\)的相邻节点中随机选择的。随机游走在内容推荐和社团发现中被用于衡量相似度。它们也是在输入图的大小的<a href="https://zh.wikipedia.org/wiki/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6#.E6.AC.A1.E7.BA.BF.E6.80.A7.E6.97.B6.E9.97.B4" target="_blank" rel="noopener">次线性时间</a>内计算局部社团结构信息的一类<a href="https://en.wikipedia.org/wiki/Output-sensitive_algorithm" target="_blank" rel="noopener">输出敏感算法</a>的基础。<br>由于这种与局部结构的联系，于是使用一个随机游走<em>流（stream）</em>作为从网络中提取信息的基本工具。除了捕获社团信息，使用随机游走作为算法的基础也提供了两个不错的属性：首先，局部探索容易并行化。许多随机游走（在不同的线程、处理器或机器上）可以同时探索一个图的不同部分。其次，依靠从短随机游走获得的信息，可以适应图形结构的小变化而不需要全局重新计算。可以用次线性时间在变化的区域进行新的随机游走来迭代更新学习的模型。</p>
<h2 id="连接：幂定律"><a href="#连接：幂定律" class="headerlink" title="连接：幂定律"></a>连接：幂定律</h2><p>之前用在线随机游走作为捕获图结构的雏形，现在需要一种合适的方法来捕获这些信息。如果连通图的度分布遵循<a href="https://zh.wikipedia.org/wiki/%E5%86%AA%E5%AE%9A%E5%BE%8B" target="_blank" rel="noopener">幂定律</a>（即无尺度），观测到在节点出现在短随机游走中的频率也将遵循幂定律分布。<br>自然语言中的词频遵循类似的分布，语言建模技术可以解释这种分布行为。本文核心贡献在于可以重新设计用于建模自然语言的技术来建模网络中的社团结构。</p>
<h2 id="语言建模"><a href="#语言建模" class="headerlink" title="语言建模"></a>语言建模</h2><p>语言建模的目的是估计特定词序列出现在语料库的可能性。给定一个词序列：</p>
<script type="math/tex; mode=display">W_1^n=(w_0,w_1,\ldots,w_n)</script><p>其中\(w_i\in\mathcal{V}\)（词表），要在语料库上最大化\({\rm Pr} (w_n\mid w_0,w_1,\ldots,w_{n-1})\)。最近在表征学习中的工作集中在使用概率神经网络来构建超过原始目标的语言模型一般表征。<br>本文中提出了一种通过短随机游走来探索图的语言模型。这些游走可以被认为是一种特殊语言的短句和短语；直接模拟是估计在随机游走中访问过观测点\(v_i\)之前所有节点的可能性：</p>
<script type="math/tex; mode=display">{\rm Pr}\big(v_i\mid (v_1,v_2,\ldots,v_{i-1})\big)</script><p>目标是学习隐式表征，不只是节点共现的概率分布，因此我们引入映射函数\(\Phi:v\in V\mapsto\mathbb{R}^{|V|\times d}\)。映射\(\Phi\)表示与图中每个节点\(v\)相关的隐式社会表征。实际上用自由参数的矩阵\(|V|\times d\)来表示\(\Phi\)。于是问题变成了估计可能性：</p>
<script type="math/tex; mode=display">{\rm Pr}\bigg(v_i\mid\big(\Phi(v_1),\Phi(v_2),\ldots,\Phi(v_{i-1})\big)\bigg)</script><p>然而随着游走距离的增长，计算这种条件概率变得不可行。于是在节点表征建模上产生了优化问题：</p>
<script type="math/tex; mode=display">\min\limits_{\Phi}\quad-\log{\rm Pr}\big(\{v_{i-w},\ldots,v_{i+w}\}\setminus v_i\mid\Phi(v_{i})\big)</script><p>用这个目标函数构建捕获节点间在局部图结构中共享相似性的表征。具有相似邻居的顶点将获得相似的表征，可以在机器学习任务上进行一般化。<br>结合缩短的随机游走和语言模型，制定了一种满足所有期望属性的方法。该方法生成存在于连续向量空间中的低维社会网络表征。它的表征编码了社团成员的隐含形式，并且由于该方法输出有用的中间表征，它可以适应变化的网络拓扑。</p>
<h1 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>在任何语言建模算法中，唯一需要的输入是语料库和词表\(\mathcal{V}\)。DeepWalk考虑一组在自身语料库中减短的随机游走，且图节点作为自己的词表（\(\mathcal{V} = V\)）。尽管在训练前已知\(V\)和随机游走节点的频率分布是有益的，但对于算法而言并不是必要的。</p>
<h2 id="算法：DeepWalk"><a href="#算法：DeepWalk" class="headerlink" title="算法：DeepWalk"></a>算法：DeepWalk</h2><p>该算法由两个主要部分组成：<strong>随机游走生成器</strong>和<strong>更新过程</strong>。随机游走生成器在图\(G\)上均匀采样一个随机节点\(v_i\)作为随机游走\(\mathcal{W}_i\)的起点。每次游走都对上一个访问到的节点均匀随机采样一个邻节点，直到达到最大长度（\(t\)）。尽管将实验中的随机游走的长度设为定值，但对于相同长度的随机游走来说没有任何限制。这些游走可能会重新开始（回到起点），但是初步结果没有显示重新开始的任何优势。在实践中对每个起始节点指定了一些长度为\(t\)的随机游走\(\gamma\)。</p>
<p><img src="/img/deepwalk1.png" alt="DeepWalk"></p>
<p><em>算法1</em>中的<em>3～9行</em>是方法的核心。外层循环指定循环次数\(\gamma\)，从每个顶点开始随机游走。每次迭代都会在数据中形成一个<em>pass</em>，并且对<em>pass</em>上的每个节点采样一个游走。在每次<em>pass</em>开始时先生成一个随机排序来遍历节点。虽不是严格要求的，但能加速随机梯度下降的收敛。<br>在内层循环迭代图上的所有节点。对每个节点\(v_i\)生成一个随机游走\(|\mathcal{W}_{v_i}|=t\)，然后使用<a href="https://arxiv.org/pdf/1301.3781.pdf" target="_blank" rel="noopener">mikolov2013efficient</a>中提出的<strong>SkipGram算法</strong>按照上面的目标函数更新表征。</p>
<h3 id="SkipGram"><a href="#SkipGram" class="headerlink" title="SkipGram"></a>SkipGram</h3><p><img src="/img/deepwalk2.png" alt="SkipGram"></p>
<p>SkipGram是一种可以使句子中出现在窗口\(w\)中的单词之间共现率最大化的语言模型。它使用独立假设近似目标函数的条件概率：</p>
<script type="math/tex; mode=display">{\rm Pr}\big(\{v_{i-w},\ldots,v_{i+w}\}\setminus v_i\mid\Phi(v_{i})\big)=\prod_{j=i-w\atop j\neq i}^{i+w}{\rm Pr}\big(v_j\mid\Phi(v_i)\big)</script><p><em>算法2</em>迭代窗口\(w\)（1～2行）内随机游走中的所有可能组合。映射每个顶点\(v_j\)到其当前表征向量\(\Phi(v_j)\in\mathbb{R}^d\)。</p>
<p><img src="/img/deepwalk3b.png" alt></p>
<p>给定\(v_j\)的表征，要最大化游走中邻节点的概率（第3行），可以使用几种选择分类器来学习这种后验分布。例如使用逻辑回归建模前面的问题将导致大量的标签。这种模型需要跨集群的庞大的计算资源。为了避免这种必要性并加快训练时间，用<strong>Hierarchical Softmax</strong>来逼近概率分布。</p>
<h3 id="Hierarchical-Softmax"><a href="#Hierarchical-Softmax" class="headerlink" title="Hierarchical Softmax"></a>Hierarchical Softmax</h3><p>给定\(u_k\in V\)，计算第3行的\({\rm Pr}\big(u_k\mid \Phi(v_j)\big)\)是不可行的。计算<a href="https://zh.wikipedia.org/wiki/%E9%85%8D%E5%88%86%E5%87%BD%E6%95%B0" target="_blank" rel="noopener">配分函数</a>（归一化因子）代价很高，所以使用Hierarchical Softmax分解条件概率。将节点分配到二叉树的叶子，把预测问题转化为最大化层次结构中特定路径的概率。</p>
<p><img src="/img/deepwalk3c.png" alt></p>
<p>如果把到节点\(u_k\)的路径看作树节点序列\((b_0,b_1,\ldots,b_{\lceil\log|V|\rceil})\)，\((b_0=root,b_{\lceil\log|V|\rceil}=u_k)\)，那么：</p>
<script type="math/tex; mode=display">{\rm Pr}\big(u_k\mid\Phi(v_j)\big)=\prod_{l=1}^{\lceil\log|V|\rceil}{\rm Pr}\big(b_l\mid\Phi(v_j)\big)</script><p>现在\({\rm Pr}\big(b_l\mid\Phi(v_j)\big)\)可用分配给节点\(b_l\)的父节点二项分类器建模：</p>
<script type="math/tex; mode=display">{\rm Pr}\big(b_l\mid\Phi(v_j)\big)=1/(1+e^{-\Phi(v_j)\cdot\Psi(b_l)})</script><p>其中\(\Psi(b_l)\in\mathbb{R}^d\)是分配给\(b_l\)父节点的表征。这样就把计算\({\rm Pr}\big(u_k\mid\Phi(v_j)\big)\)的复杂度从\(O(|V|)\)降到了\(O(\log|V|)\)。<br>可以通过在随机游走中为高频节点分配较短的路径来加快训练过程。霍夫曼编码就用于减少树中高频元素的访问时间。</p>
<h3 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h3><p>模型参数集是\(\theta=\{\Phi,\Psi\}\)，其中每个大小都是\(O(d|V|)\)。用<a href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent" target="_blank" rel="noopener">随机梯度下降法</a>（SGD）来优化这些参数（<em>算法2</em>第4行）。使用<a href="https://zh.wikipedia.org/wiki/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95" target="_blank" rel="noopener">反向传播算法</a>估计导数。SGD的学习率\(\alpha\)在训练开始时初始设置为\(2.5％\)，然后根据节点数线性下降。</p>
<h2 id="并行性"><a href="#并行性" class="headerlink" title="并行性"></a>并行性</h2><p>社会网络随机游走的节点和语言中的词汇频率分布都遵循幂定律，导致低频节点距离较长，因此影响\(\Phi\)的更新在本质上是稀疏的。于是在多协作的情况下使用异步随机梯度下降（ASGD）。鉴于更新是稀疏的，且没有加访问模型共享参数的锁，ASGD将达到最佳收敛率。尽管实验是在一台机器上用多线程进行，但已经证明这种技术具有高度可扩展性，并可用于超大规模的机器学习。</p>
<h2 id="算法变型"><a href="#算法变型" class="headerlink" title="算法变型"></a>算法变型</h2><h3 id="流"><a href="#流" class="headerlink" title="流"></a>流</h3><p>该方法的一个有趣的变型是<em>流式（streaming）</em>方法，可以在不了解整个图的情况下实现。在这种变型中图中的小游走直接传递到表征学习代码并且直接更新模型。还需要对学习过程进行一些修改。首先，使用衰减学习率可能不再可行，因为假设了对总语料库大小的认知。相反可以将学习率\(\alpha\)初始化为一个小常量。这将需要更长时间去学习，但在某些应用中可能更有价值。其次，不一定要再建立一个参数树。如果\(V\)的基数已知（或有界），可以为其最大值构建Hierarchical Softmax树。首次看到节点可以为其分配一个叶。如果能够先验估计节点频率，还可以使用霍夫曼编码来降低高频元素的访问时间。</p>
<h3 id="非随机游走"><a href="#非随机游走" class="headerlink" title="非随机游走"></a>非随机游走</h3><p>一些图被作为与一系列元素交互的代理而创建（如页面导航）。当通过这种非随机游走的流建图时，可以使用此过程直接提供建模。以这种方式采样的图不仅捕获与网络结构相关的信息，还有遍历路径的频率。<br>这种变型还包括语言模型。句子可被看作在经过适当设计的语言网络进行有目的地游走，并且像SkipGram这样的语言模型是为捕获这种行为而设计的。<br>这种方法可以与流式方法结合，在不断进化的网络上无需构建全图而训练特征。用这种技术维护表征可以无需处理网络规模图而实现网络规模分类。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9920928489161252"
     data-ad-slot="3913131990"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



  
    <article id="post-nat6" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
<a href="/posts/nat6/" class="article-date">
  <time datetime="2017-03-13T05:13:13.000Z" itemprop="datePublished">2017-03-13</time>
</a>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/奇技淫巧/">奇技淫巧</a>►<a class="article-category-link" href="/categories/奇技淫巧/路由器/">路由器</a>
  </div>

  </div>
  <div class="article-inner">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/img/nat6banner.png" rel="gallery_ck4p7xq1b000w3ph83a6mh1c1">
        <img src="/img/nat6banner.png" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/nat6/">PandoraBox路由器的IPv6穿透</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="https://liangzhenduo0608.github.io/posts/nat6/" data-id="ck4p7xq1b000w3ph83a6mh1c1" class="article-share-link">Share</a>
      
        <a href="https://liangzhenduo0608.github.io/posts/nat6/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/IPv6/">IPv6</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenWrt/">OpenWrt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PandoraBox/">PandoraBox</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ShadowSocks/">ShadowSocks</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/科学上网/">科学上网</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/路由器/">路由器</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <p>2015年年底的时候学校升级了校园网的计费系统，当时用的路由器（大概由于配置姿势不对）一直获取不到IPv6地址。好在之后每人每月给了免费5G流量，电脑直接使用IPv6的代理，免费流量只给手机用还算熬的过去，所以就一直没再折腾。直到前些天入手了一个斐讯K2，所以想碰碰运气，结果乱搞了一通就成功了。</p>
<p>最开始拿到学校插上网线总是未连接状态，刷了好几种固件都没用<del>，最后发现是网线水晶头接触不良</del>。由于OpenWrt对K2的支持还不是很好，可能出现WiFi不稳定的状况，最后我还是刷了一个PandoraBox，但方法是和OpenWrt通用的。</p>
<h1 id="获取IPv6地址"><a href="#获取IPv6地址" class="headerlink" title="获取IPv6地址"></a>获取IPv6地址</h1><p>首先更改<code>网络</code>-<code>接口</code>设置。<code>WAN</code>选用<code>DHCP客户端</code>即可，<code>WAN6</code>要用默认的<code>DHCPv6客户端</code>，但是要改成<strong>强制</strong>请求IPv6地址并<strong>禁用</strong>请求指定长度的IPv6前缀：</p>
<p><img src="/img/nat6wan6.png" alt="WAN6"></p>
<p>这时可以重新连接一下看看WAN6是否出现了IPv6地址，如果依旧没有，可以按照<a href="https://wiki.openwrt.org/doc/uci/network6?s[]=ipv6&amp;s[]=relay#upstream_configuration_for_wan_interfaces" target="_blank" rel="noopener">官方文档</a>所说将<code>wan</code>的<code>ipv6</code>选项设为<code>1</code>：</p>
<pre><code>uci set network.wan.ipv6=&#39;1&#39;
uci commit network
</code></pre><p>再重新连接应当就能获取到IPv6地址了：</p>
<p><img src="/img/nat6interface.png" alt="接口总览"></p>
<h1 id="安装NAT6"><a href="#安装NAT6" class="headerlink" title="安装NAT6"></a>安装NAT6</h1><p>最早的时候使用6relayd来实现IPv6网络穿透的，但是这个软件很早之前就被弃用了，现在当然不能再使用这么古老的方法了，所以就在网上寻找新的方法，最后根据<a href="https://wiki.openwrt.org/doc/howto/ipv6.nat6" target="_blank" rel="noopener">官方文档</a>发现了通过NAT6使设备获取IPv6地址的方法。</p>
<p>首先安装必要的软件：</p>
<pre><code>opkg update
opkg install kmod-ipt-nat6
</code></pre><p>然后把IPv6 ULA前缀改成<code>d</code>开头的：</p>
<pre><code>uci set network.globals.ula_prefix=&quot;$(uci get network.globals.ula_prefix | sed &#39;s/^./d/&#39;)&quot;
uci commit network
</code></pre><p>官方文档对这个操作的解释是<em>默认前缀是非全局路由的地址，大多路客户端在没有全局IPv6地址的情况下只有IPv4地址，所以需要将前缀改成未使用过的全局地址的样子</em>。</p>
<p>接下来更改DHCP服务器的设置：</p>
<pre><code>uci set dhcp.lan.ra_default=&#39;1&#39;
uci commit dhcp
</code></pre><p>之后修改<code>/etc/sysctl.conf</code>，将以下内容加进去：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">net.ipv6.conf.default.forwarding=2</span><br><span class="line">net.ipv6.conf.all.forwarding=2</span><br><span class="line">net.ipv6.conf.default.accept_ra=2</span><br><span class="line">net.ipv6.conf.all.accept_ra=2</span><br></pre></td></tr></table></figure>
<p>最后在<code>/etc/firewall.user</code>添加防火墙规则：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip6tables -t nat -I POSTROUTING -s $(uci get network.globals.ula_prefix) -j MASQUERADE</span><br></pre></td></tr></table></figure>
<p>重启路由器后再次连接看电脑是否已经得到路由器分配的IPv6地址了：</p>
<p><img src="/img/nat6address.png" alt="Network"></p>
<h1 id="安装ShadowSocks"><a href="#安装ShadowSocks" class="headerlink" title="安装ShadowSocks"></a>安装ShadowSocks</h1><p>安装ShadowSocks和luci界面：</p>
<pre><code>opkg update
opkg install shadowsocks-libev
opkg install luci-app-shadowsocks
</code></pre><p>然后在<code>服务</code>-<code>ShadowSocks</code>中配置服务器信息并启用<code>ss-redir</code>模式即可：</p>
<p><img src="/img/nat6shadowsocks.png" alt="ShadowSocks"></p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9920928489161252"
     data-ad-slot="3913131990"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



  
    <article id="post-breed" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
<a href="/posts/breed/" class="article-date">
  <time datetime="2017-02-24T04:12:12.000Z" itemprop="datePublished">2017-02-24</time>
</a>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/奇技淫巧/">奇技淫巧</a>►<a class="article-category-link" href="/categories/奇技淫巧/路由器/">路由器</a>
  </div>

  </div>
  <div class="article-inner">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/img/breedbanner.png" rel="gallery_ck4p7xq0z000b3ph8hlz0tl3i">
        <img src="/img/breedbanner.png" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/breed/">路由器刷breed引导第三方固件</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="https://liangzhenduo0608.github.io/posts/breed/" data-id="ck4p7xq0z000b3ph8hlz0tl3i" class="article-share-link">Share</a>
      
        <a href="https://liangzhenduo0608.github.io/posts/breed/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenWrt/">OpenWrt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/路由器/">路由器</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <p>之前早就听说<strong>斐讯</strong>路由器有个<em><a href="http://www.phicomm.com/cn/index.php/News/detail/cateid/2/id/372.html" target="_blank" rel="noopener">0元购</a></em>活动，一直没往心里去；直到昨天看到<a href="http://weibo.com/xforce" target="_blank" rel="noopener">XForce</a>大神也撸了一台，于是<del>江信江疑</del>跟风在<em>二手东</em>下了一单，结果今天就上船了，但愿30天内别翻船，才算真的免费拿到手啊。</p>
<p>收货后先别急刮K码，刮开了万一有毛病就不给退换了。先登<a href="http://192.168.2.1/" target="_blank" rel="noopener">192.168.2.1</a>配置一下网络，发现原厂固件功能还算齐全，一般情况都够用了。但是据说有人发现路由器暗地里在给某些服务器传送着数据，恐怕有信息泄露的风险，当然刷一个第三方固件更保险一些了。</p>
<p>我拿到的<strong>斐讯K2</strong>硬件版本是<code>A2</code>，固件版本是<code>22.4.5.42</code>。听闻说更高版本的固件刷Breed非常麻烦，我还比较庆幸原厂版本比较低，然而依然要降级。</p>
<h1 id="刷入breed"><a href="#刷入breed" class="headerlink" title="刷入breed"></a>刷入breed</h1><h2 id="下载工具"><a href="#下载工具" class="headerlink" title="下载工具"></a>下载工具</h2><p>首先下载huzibbs大神制作的<strong>路由器刷breed Web助手通用版</strong>（<a href="https://soft.ctfile.com/info/xoc403020" target="_blank" rel="noopener">城通网盘</a>），可以实现一键刷telnet、ssh、breed。</p>
<p>然后将路由器<strong>LAN</strong>口（推荐使用LAN4口）与Windows电脑用<strong>网线</strong>相连（一定不要使用WiFi），然后长按路由器Reset键5秒恢复出厂设置。之后可以再访问一下<a href="http://192.168.2.1/" target="_blank" rel="noopener">192.168.2.1</a>看是不是初始状态。</p>
<h2 id="开始刷机"><a href="#开始刷机" class="headerlink" title="开始刷机"></a>开始刷机</h2><p>如果一切正常就以管理员身份运行<strong>路由器刷breed Web助手通用版</strong>：</p>
<p><img src="/img/breedassistant.png" alt="路由器刷breed Web助手通用版"></p>
<p>配置如图即可，注意其中刷机方案一定要选择<code>斐讯k1,k1s,k2全自动方案</code>，然后点击<code>开始刷机</code>即可。</p>
<p>开始刷机前工具作者建议先手动禁用除<code>以太网</code>以外的其他网络连接。由于工具中途会调用另外几个程序，所以中途如果系统弹出了提示框允许即可，顺便设成不再提醒；如果弹窗导致刷机失败了重新再来一遍基本就可以了。<em>成功后请忽略下面的步骤，直接进入下一小节。</em></p>
<p>如果一直失败，出现类似ssh无法连接的错误，因为此时固件应当已经降级到有ssh的测试版本了，也可以手动ssh进去（用户名和密码都是<code>root</code>）执行刷机步骤，但此时操作一定要谨慎，否则极有可能变砖！</p>
<p>下载路由器对应的<a href="https://breed.hackpascal.net/" target="_blank" rel="noopener">breed</a>包（如<code>breed-mt7620-phicomm-psg1208.bin</code>）下载到路由器，切记一定不要选错，然后执行：</p>
<pre><code>mtd unlock Bootloader
mtd -r write breed-mt7620-phicomm-psg1208.bin Bootloader
</code></pre><p>执行完后应当会自动重启。这种方法理论上可行，具体细节有待验证，请谨慎使用。</p>
<h2 id="重启路由器"><a href="#重启路由器" class="headerlink" title="重启路由器"></a>重启路由器</h2><p>几分钟之后刷机自动完成，按照工具提示<strong>等待2分钟以后</strong>再断电。在重新通电前先按住Reset键再接通电源，持续按住Reset键约5秒钟再松手。不出意外此时路由器应该进入了breed引导，这时访问<a href="http://192.168.1.1/" target="_blank" rel="noopener">192.168.1.1</a>应当就进入了<strong>Breed Web 恢复控制台</strong>：</p>
<p><img src="/img/breedweb.png" alt="Breed Web 恢复控制台"></p>
<h1 id="刷入第三方固件"><a href="#刷入第三方固件" class="headerlink" title="刷入第三方固件"></a>刷入第三方固件</h1><h2 id="固件备份"><a href="#固件备份" class="headerlink" title="固件备份"></a>固件备份</h2><p>进入控制台后，先到<code>固件备份</code>里将<code>EEPROM</code>和<code>编程器固件</code>备份一下：</p>
<p><img src="/img/breedbackup.png" alt="固件备份"></p>
<h2 id="恢复出厂设置"><a href="#恢复出厂设置" class="headerlink" title="恢复出厂设置"></a>恢复出厂设置</h2><p>然后到<code>恢复出厂设置</code>将固件恢复<code>Config区（公版）</code>：</p>
<p><img src="/img/breedreset.png" alt="恢复出厂设置"></p>
<h2 id="固件更新"><a href="#固件更新" class="headerlink" title="固件更新"></a>固件更新</h2><p>最后到<code>固件更新</code>选择要刷的固件上传即可：</p>
<p><img src="/img/breedupdate.png" alt="固件更新"></p>
<p>目前K2可刷的固件有很多，包括<a href="https://downloads.openwrt.org/" target="_blank" rel="noopener">OpenWrt</a>、<a href="http://downloads.pandorabox.com.cn/" target="_blank" rel="noopener">PandoraBox</a>等等。虽然OpenWrt还没有放出针对K2的Release版本，但由于它用的是<strong>ramips</strong>架构的<strong>mt7620</strong>芯片，所以一般mt7620芯片的路由器固件是通用的，于是我就刷了个小米路由器的<a href="https://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/mt7620/openwrt-15.05.1-ramips-mt7620-xiaomi-miwifi-mini-squashfs-sysupgrade.bin" target="_blank" rel="noopener">固件</a>：</p>
<p><img src="/img/breedwrt.png" alt="OpenWrt"></p>
<p>而潘多拉盒子已经有了K2的稳定版<a href="http://downloads.pandorabox.com.cn/pandorabox-16-10-stable/targets/ralink/mt7620/PandoraBox-ralink-mt7620-phicomm-k2-2017-01-03-git-6c24a7a-squashfs-sysupgrade.bin" target="_blank" rel="noopener">固件</a>。另外给K2装软件时记得下载<strong>ramips</strong>架构的ipk包。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9920928489161252"
     data-ad-slot="3913131990"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



  
    <article id="post-raspi-oled" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
<a href="/posts/raspi-oled/" class="article-date">
  <time datetime="2017-02-07T13:11:11.000Z" itemprop="datePublished">2017-02-07</time>
</a>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/奇技淫巧/">奇技淫巧</a>►<a class="article-category-link" href="/categories/奇技淫巧/树莓派/">树莓派</a>
  </div>

  </div>
  <div class="article-inner">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/img/oledbanner.png" rel="gallery_ck4p7xq1d00103ph860716yat">
        <img src="/img/oledbanner.png" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/raspi-oled/">树莓派SPI驱动OLED屏幕</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="https://liangzhenduo0608.github.io/posts/raspi-oled/" data-id="ck4p7xq1d00103ph860716yat" class="article-share-link">Share</a>
      
        <a href="https://liangzhenduo0608.github.io/posts/raspi-oled/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/树莓派/">树莓派</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <p>曾经在B站看到过有人用树莓派连接OLED屏幕播放<strong><em>Bad Apple</em></strong>（有屏幕的地方就有<strong><em>Bad Apple</em></strong>），想到前些年在智能车打酱油时遗留下的一块128*64的OLED屏幕，就想给树莓派加一个monitor。</p>
<h1 id="连接引脚"><a href="#连接引脚" class="headerlink" title="连接引脚"></a>连接引脚</h1><p><img src="/img/oledpin.png" alt="物理编号"></p>
<p>屏幕上有7个引脚，与树莓派用母对母杜邦线连接，接法如下表：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>OLED引脚</th>
<th>功能</th>
<th>树莓派引脚</th>
<th>编号</th>
</tr>
</thead>
<tbody>
<tr>
<td>GND</td>
<td></td>
<td>GND</td>
<td>25</td>
</tr>
<tr>
<td>VCC</td>
<td></td>
<td>3.3V PWR</td>
<td>17</td>
</tr>
<tr>
<td>D0</td>
<td>SCLK</td>
<td>GPIO 11</td>
<td>23</td>
</tr>
<tr>
<td>D1</td>
<td>MOSI</td>
<td>GPIO 10</td>
<td>19</td>
</tr>
<tr>
<td>RST</td>
<td></td>
<td>GPIO 17</td>
<td>11</td>
</tr>
<tr>
<td>DC</td>
<td></td>
<td>GPIO 27</td>
<td>13</td>
</tr>
<tr>
<td>CS</td>
<td>CS0</td>
<td>GPIO 8</td>
<td>24</td>
</tr>
</tbody>
</table>
</div>
<h1 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h1><p>在驱动屏幕之前要先启用SPI：</p>
<pre><code>sudo raspi-config
</code></pre><p>然后选择<code>Advanced Options</code>里的<code>SPI</code>并启用它，然后执行<code>sudo reboot</code>重启。重启后执行<code>ls /dev | grep spi</code>，如果显示：</p>
<blockquote>
<p>spidev0.0<br>spidev0.1</p>
</blockquote>
<p>就说明设置生效了。</p>
<p>先安装一些要用到的Python模块：</p>
<pre><code>sudo apt-get install build-essential python-dev python-pip
sudo apt-get install python-imaging python-smbus
sudo pip install RPi.GPIO
</code></pre><p>然后克隆SPI的驱动模块并安装：</p>
<pre><code>git clone https://github.com/adafruit/Adafruit_Python_SSD1306.git
cd Adafruit_Python_SSD1306
sudo python setup.py install
</code></pre><h1 id="编写脚本"><a href="#编写脚本" class="headerlink" title="编写脚本"></a>编写脚本</h1><p>网上有人给出了Python版的测试Demo：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python/</span></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> Adafruit_GPIO.SPI <span class="keyword">as</span> SPI</span><br><span class="line"><span class="keyword">import</span> Adafruit_SSD1306</span><br><span class="line"><span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> ImageDraw</span><br><span class="line"><span class="keyword">import</span> ImageFont</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Raspberry Pi pin configuration:</span></span><br><span class="line">RST = <span class="number">17</span></span><br><span class="line"><span class="comment"># Note the following are only used with SPI:</span></span><br><span class="line">DC = <span class="number">27</span></span><br><span class="line">SPI_PORT = <span class="number">0</span></span><br><span class="line">SPI_DEVICE = <span class="number">0</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 128x64 display with hardware SPI:</span></span><br><span class="line">disp = Adafruit_SSD1306.SSD1306_128_64(rst=RST, dc=DC, spi=SPI.SpiDev(SPI_PORT, SPI_DEVICE, max_speed_hz=<span class="number">8000000</span>))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Initialize library.</span></span><br><span class="line">disp.begin()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Clear display.</span></span><br><span class="line">disp.clear()</span><br><span class="line">disp.display()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Create blank image for drawing.</span></span><br><span class="line"><span class="comment"># Make sure to create image with mode '1' for 1-bit color.</span></span><br><span class="line">width = disp.width</span><br><span class="line">height = disp.height</span><br><span class="line">image = Image.new(<span class="string">'1'</span>, (width, height))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Get drawing object to draw on image.</span></span><br><span class="line">draw = ImageDraw.Draw(image)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Draw a black filled box to clear the image.</span></span><br><span class="line">draw.rectangle((<span class="number">0</span>,<span class="number">0</span>,width,height), outline=<span class="number">0</span>, fill=<span class="number">0</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Draw some shapes.</span></span><br><span class="line"><span class="comment"># First define some constants to allow easy resizing of shapes.</span></span><br><span class="line">padding = <span class="number">1</span></span><br><span class="line">top = padding</span><br><span class="line">x = padding</span><br><span class="line"><span class="comment"># Load default font.</span></span><br><span class="line">font = ImageFont.load_default()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Alternatively load a TTF font.</span></span><br><span class="line"><span class="comment"># Some other nice fonts to try: http://www.dafont.com/bitmap.php</span></span><br><span class="line"><span class="comment">#font = ImageFont.truetype('Minecraftia.ttf', 8)</span></span><br><span class="line"> </span><br><span class="line">draw.text((x, top), <span class="string">'This is first line'</span>, font=font, fill=<span class="number">255</span>)</span><br><span class="line">draw.text((x, top+<span class="number">10</span>), <span class="string">'This is second line'</span>, font=font, fill=<span class="number">255</span>)</span><br><span class="line">draw.text((x, top+<span class="number">20</span>), <span class="string">'This is third line'</span>, font=font, fill=<span class="number">255</span>)</span><br><span class="line">draw.text((x, top+<span class="number">30</span>), <span class="string">'This is fourth line'</span>, font=font, fill=<span class="number">255</span>)</span><br><span class="line">draw.text((x, top+<span class="number">40</span>), <span class="string">'This is fifth line'</span>, font=font, fill=<span class="number">255</span>)</span><br><span class="line">draw.text((x, top+<span class="number">50</span>), <span class="string">'This is last line'</span>, font=font, fill=<span class="number">255</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Display image.</span></span><br><span class="line">disp.image(image)</span><br><span class="line">disp.display()</span><br></pre></td></tr></table></figure>
<p>如果运行它能正常显示就可以编写自己的脚本了。参考这个Demo我又撸了一个显示系统实时信息的脚本：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python/</span></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> fcntl</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> Adafruit_GPIO.SPI <span class="keyword">as</span> SPI</span><br><span class="line"><span class="keyword">import</span> Adafruit_SSD1306</span><br><span class="line"><span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> ImageDraw</span><br><span class="line"><span class="keyword">import</span> ImageFont</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">raminfo</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'/proc/meminfo'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        total = float(f.readline().split()[<span class="number">1</span>])</span><br><span class="line">        free = float(f.readline().split()[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> format((total-free)/total, <span class="string">'.1%'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">diskinfo</span><span class="params">()</span>:</span></span><br><span class="line">    st = os.statvfs(<span class="string">'/'</span>)</span><br><span class="line">    total = float(st.f_blocks * st.f_frsize)</span><br><span class="line">    used = float(st.f_blocks - st.f_bfree) * st.f_frsize</span><br><span class="line">    <span class="keyword">return</span> format(used/total, <span class="string">'.1%'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cpuinfo</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'/proc/stat'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        info = f.readline().split()</span><br><span class="line">        t0 = float(info[<span class="number">1</span>]) + float(info[<span class="number">2</span>]) + float(info[<span class="number">3</span>])</span><br><span class="line">        s0 = t0 + float(info[<span class="number">4</span>]) + float(info[<span class="number">5</span>]) + float(info[<span class="number">6</span>]) + float(info[<span class="number">7</span>])</span><br><span class="line">    time.sleep(<span class="number">0.033</span>)</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'/proc/stat'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        info = f.readline().split()</span><br><span class="line">        t1 = float(info[<span class="number">1</span>]) + float(info[<span class="number">2</span>]) + float(info[<span class="number">3</span>])</span><br><span class="line">        s1 = t1 + float(info[<span class="number">4</span>]) + float(info[<span class="number">5</span>]) + float(info[<span class="number">6</span>]) + float(info[<span class="number">7</span>])</span><br><span class="line">    <span class="keyword">return</span> format((t1-t0)/(s1-s0), <span class="string">'.1%'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cputemp</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'/sys/class/thermal/thermal_zone0/temp'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        temp = float(f.readline())</span><br><span class="line">    <span class="keyword">return</span> format(temp/<span class="number">1000</span>, <span class="string">'.1f'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wifiinfo</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'/proc/net/wireless'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.readline()</span><br><span class="line">        f.readline()</span><br><span class="line">        info = f.readline().split()</span><br><span class="line">    <span class="keyword">return</span> info[<span class="number">3</span>][:<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_ip_address</span><span class="params">(ifname)</span>:</span></span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line">    <span class="keyword">return</span> socket.inet_ntoa(fcntl.ioctl(</span><br><span class="line">        s.fileno(),</span><br><span class="line">        <span class="number">0x8915</span>,  <span class="comment"># SIOCGIFADDR</span></span><br><span class="line">        struct.pack(<span class="string">'256s'</span>, ifname[:<span class="number">15</span>])</span><br><span class="line">    )[<span class="number">20</span>:<span class="number">24</span>])</span><br><span class="line"></span><br><span class="line">IP = requests.get(<span class="string">'http://ip.3322.net'</span>).text</span><br><span class="line"></span><br><span class="line"><span class="comment"># Raspberry Pi pin configuration:</span></span><br><span class="line">RST = <span class="number">17</span></span><br><span class="line">DC = <span class="number">27</span></span><br><span class="line">SPI_PORT = <span class="number">0</span></span><br><span class="line">SPI_DEVICE = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 128x64 display with hardware SPI:</span></span><br><span class="line">disp = Adafruit_SSD1306.SSD1306_128_64(rst=RST, dc=DC, spi=SPI.SpiDev(SPI_PORT, SPI_DEVICE, max_speed_hz=<span class="number">8000000</span>))</span><br><span class="line"><span class="comment"># Initialize library.</span></span><br><span class="line">disp.begin()</span><br><span class="line"><span class="comment"># Clear display.</span></span><br><span class="line">disp.clear()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    disp.display()</span><br><span class="line">    <span class="comment"># Create blank image for drawing.</span></span><br><span class="line">    width = disp.width</span><br><span class="line">    height = disp.height</span><br><span class="line">    image = Image.new(<span class="string">'1'</span>, (width, height))</span><br><span class="line">    <span class="comment"># Get drawing object to draw on image.</span></span><br><span class="line">    draw = ImageDraw.Draw(image)</span><br><span class="line">    <span class="comment"># Initialize background.</span></span><br><span class="line">    draw.rectangle((<span class="number">0</span>,<span class="number">0</span>,width,height), outline=<span class="number">0</span>, fill=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    padding = <span class="number">1</span></span><br><span class="line">    top = padding</span><br><span class="line">    x = padding</span><br><span class="line">    font = ImageFont.load_default()</span><br><span class="line"></span><br><span class="line">    draw.text((x, top), time.strftime(<span class="string">" %Y-%m-%d %H:%M:%S "</span>,time.localtime(time.time())), font=font, fill=<span class="number">255</span>)</span><br><span class="line">    draw.text((x, top+<span class="number">14</span>), <span class="string">'disk:'</span> + diskinfo() + <span class="string">'  RAM:'</span> + raminfo(), font=font, fill=<span class="number">255</span>)</span><br><span class="line">    draw.text((x, top+<span class="number">24</span>), <span class="string">'temp:'</span> + cputemp() + <span class="string">'C  CPU:'</span> + cpuinfo(), font=font, fill=<span class="number">255</span>)</span><br><span class="line">    draw.text((x, top+<span class="number">34</span>), <span class="string">'signal:'</span> + wifiinfo() + <span class="string">'dBm'</span>, font=font, fill=<span class="number">255</span>)</span><br><span class="line">    draw.text((x, top+<span class="number">44</span>), <span class="string">'LAN:'</span> + get_ip_address(<span class="string">'wlan0'</span>), font=font, fill=<span class="number">255</span>)</span><br><span class="line">    draw.text((x, top+<span class="number">54</span>), <span class="string">'WAN:'</span> + IP, font=font, fill=<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Display image.</span></span><br><span class="line">    disp.image(image)</span><br><span class="line">    disp.display()</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p><img src="/img/oled.gif" alt></p>
<h1 id="开机启动"><a href="#开机启动" class="headerlink" title="开机启动"></a>开机启动</h1><p>先新建一个Unit配置文件：</p>
<pre><code>sudo vim /etc/systemd/system/oled.service
</code></pre><p>内容如下：</p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[Unit]</span></span><br><span class="line">Description=oled autostart</span><br><span class="line"></span><br><span class="line"><span class="string">[Service]</span></span><br><span class="line">Type=idle</span><br><span class="line">ExecStart=/usr/bin/python /home/pi/oled.py</span><br><span class="line">Restart=always</span><br><span class="line"></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>
<p>然后启动并加入启动项：</p>
<pre><code>sudo systemctl daemon-reload
sudo systemctl start oled
sudo systemctl enable oled
</code></pre>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9920928489161252"
     data-ad-slot="3913131990"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



  
    <article id="post-ssh-add" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
<a href="/posts/ssh-add/" class="article-date">
  <time datetime="2017-01-23T14:22:22.000Z" itemprop="datePublished">2017-01-23</time>
</a>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/奇技淫巧/">奇技淫巧</a>►<a class="article-category-link" href="/categories/奇技淫巧/macOS/">macOS</a>
  </div>

  </div>
  <div class="article-inner">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/img/sshaddbanner.png" rel="gallery_ck4p7xq1g00153ph8uqai264m">
        <img src="/img/sshaddbanner.png" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/ssh-add/">macOS自动添加ssh密钥</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="https://liangzhenduo0608.github.io/posts/ssh-add/" data-id="ck4p7xq1g00153ph8uqai264m" class="article-share-link">Share</a>
      
        <a href="https://liangzhenduo0608.github.io/posts/ssh-add/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ssh/">ssh</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <p>本来是没有这种问题的，但是自从macOS升级到<strong>Sierra 10.12</strong>以后<code>ssh-agent</code>不会自动加载密码短语了，每次重启后ssh登机器时总是提示输入密钥的密码短语，所以每次开机都要用<code>ssh-add -K ~/.ssh/id_rsa</code>将它手动添加到钥匙串中才行。</p>
<p>后来在<a href="https://github.com/lionheart/openradar-mirror/issues/15361#issuecomment-270242512" target="_blank" rel="noopener">GitHub</a>找到了解决方案，其实就是简单配置了一下<code>~/.ssh/config</code>：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Host</span> *</span><br><span class="line">    UseKeychain <span class="literal">yes</span></span><br><span class="line">    AddKeysToAgent <span class="literal">yes</span></span><br><span class="line">    IdentityFile ~/.ssh/id_rsa</span><br><span class="line">    IdentityFile ~/.ssh/github_rsa</span><br></pre></td></tr></table></figure>
<p>用<code>IdentityFile</code>指定要自动添加的密钥即可。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9920928489161252"
     data-ad-slot="3913131990"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



  
    <article id="post-kancolle-android" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
<a href="/posts/kancolle-android/" class="article-date">
  <time datetime="2016-11-27T14:22:22.000Z" itemprop="datePublished">2016-11-27</time>
</a>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/ACG/">ACG</a>►<a class="article-category-link" href="/categories/ACG/艦隊これくしょん/">艦隊これくしょん</a>
  </div>

  </div>
  <div class="article-inner">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/img/kcabanner.png" rel="gallery_ck4p7xq17000p3ph8k7yljter">
        <img src="/img/kcabanner.png" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/kancolle-android/">「艦これ」Android版運用</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="https://liangzhenduo0608.github.io/posts/kancolle-android/" data-id="ck4p7xq17000p3ph8k7yljter" class="article-share-link">Share</a>
      
        <a href="https://liangzhenduo0608.github.io/posts/kancolle-android/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/游戏/">游戏</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/舰队Collection/">舰队Collection</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <p>舰队Collection之前出了Android版，最开始需要预约抽签才能登录，2016年8月份开始全体提督都可以玩了。Android版有一个好处就是（除首次登录外）<strong>无需代理</strong>即可随时随地肝船了。</p>
<h1 id="下载安装DMM-Game-Store"><a href="#下载安装DMM-Game-Store" class="headerlink" title="下载安装DMM Game Store"></a>下载安装DMM Game Store</h1><p>先到<a href="http://www.dmm.com/app/-/appstore/download/" target="_blank" rel="noopener">DMM App Store</a>下载<a href="http://portalapp.dmm.com/dmmappstore/DMMGameStore.apk" target="_blank" rel="noopener">安装包</a>，安装完毕打开任意代理（只要不是中国大陆的地址就行）后打开游戏中心，点右上角游戏按钮登录：</p>
<p><img src="/img/kcastore.png" alt="DMM Game Store"></p>
<p>登录后选择<strong>艦隊これくしょん -艦これ-</strong>并下载：</p>
<p><img src="/img/kcadownload.png" alt="ダウンロード"></p>
<h1 id="安装运行「艦これ」"><a href="#安装运行「艦これ」" class="headerlink" title="安装运行「艦これ」"></a>安装运行「艦これ」</h1><p>下载完了直接安装就行了，此时就不需要代理了，然后直接启动：</p>
<p><img src="/img/kcastart.png" alt="スタート"></p>
<p>此时按<strong><del>ミュージック</del>スタート</strong>就进入游戏了，游戏本身和网页版大同小异：</p>
<p><img src="/img/kcaandroid.png" alt="Kan Colle"></p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9920928489161252"
     data-ad-slot="3913131990"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



  
    <article id="post-terminal" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
<a href="/posts/terminal/" class="article-date">
  <time datetime="2016-11-11T13:11:11.000Z" itemprop="datePublished">2016-11-11</time>
</a>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/奇技淫巧/">奇技淫巧</a>►<a class="article-category-link" href="/categories/奇技淫巧/＊nix/">＊nix</a>
  </div>

  </div>
  <div class="article-inner">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/img/terbanner.png" rel="gallery_ck4p7xq1i00193ph8d8w29tub">
        <img src="/img/terbanner.png" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/terminal/">终端开发终极配置</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="https://liangzhenduo0608.github.io/posts/terminal/" data-id="ck4p7xq1i00193ph8d8w29tub" class="article-share-link">Share</a>
      
        <a href="https://liangzhenduo0608.github.io/posts/terminal/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unix/">Unix</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/">shell</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <p>终端是每天要用到的工具，所以一定要配置成自己顺手的，才能发挥更高的效率。<strong>iTerm2+zsh+vim</strong>是我目前用过的感觉最强大的配置方案了。</p>
<h1 id="iTerm2"><a href="#iTerm2" class="headerlink" title="iTerm2"></a>iTerm2</h1><p><a href="https://www.iterm2.com/" target="_blank" rel="noopener">iTerm2</a>是默认终端的终极替代方案，个性化、热键等方面表现非常出色，兼容性也非常好。</p>
<p><img src="/img/teriterm.png" alt="iTerm2"></p>
<p>直接到其<a href="https://www.iterm2.com/downloads.html" target="_blank" rel="noopener">官网</a>下载安装即可。</p>
<p>对于终端里的特殊字符可能有的无法显示，要安装<code>powerline</code>字体：</p>
<pre><code>git clone https://github.com/powerline/fonts.git --depth=1
cd fonts &amp;&amp; ./install.sh
</code></pre><p>然后在Preferences - Profiles - Text - Font里选择powerline字体就可以了。</p>
<h1 id="zsh"><a href="#zsh" class="headerlink" title="zsh"></a>zsh</h1><p><strong>zsh</strong>在命令补全等很多方面上比bash智能很多，首先切换到zsh：</p>
<pre><code>chsh -s /bin/zsh
</code></pre><p><a href="http://ohmyz.sh/" target="_blank" rel="noopener">oh-my-zsh</a>是一个管理zsh配置的框架，包含各种插件和主题，可用以下脚本安装：</p>
<pre><code>sh -c &quot;$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;
</code></pre><p><img src="/img/terzsh.png" alt="oh-my-zsh"></p>
<p>安装完成后编辑<code>~/.zshrc</code>，可以编辑<code>ZSH_THEME</code>修改主题，或者编辑<code>plugins</code>增加插件，对应的文件分别在<code>~/.oh-my-zsh/themes</code>和<code>~/.oh-my-zsh/plugins</code>下。</p>
<h1 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h1><p><a href="http://vim.spf13.com/" target="_blank" rel="noopener">spf13-vim</a>是vim的终极配置之一，用以下脚本安装：</p>
<pre><code>curl https://j.mp/spf13-vim3 -L &gt; spf13-vim.sh &amp;&amp; sh spf13-vim.sh
</code></pre><p><img src="/img/tervim.png" alt="spf13-vim"></p>
<p>配色文件在<code>~/.vim/bundle/vim-colorschemes/colors</code>下，指定名称修改配色：</p>
<pre><code>echo colorscheme $colorscheme_name  &gt;&gt; ~/.vimrc.local
</code></pre>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9920928489161252"
     data-ad-slot="3913131990"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



  
    <article id="post-mac-php" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
<a href="/posts/mac-php/" class="article-date">
  <time datetime="2016-10-31T13:11:11.000Z" itemprop="datePublished">2016-10-31</time>
</a>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/手帐/">手帐</a>►<a class="article-category-link" href="/categories/手帐/实习/">实习</a>
  </div>

  </div>
  <div class="article-inner">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/img/mpbanner.png" rel="gallery_ck4p7xq1a000t3ph8v7lpdhzm">
        <img src="/img/mpbanner.png" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/mac-php/">macOS配置PHP开发环境</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="https://liangzhenduo0608.github.io/posts/mac-php/" data-id="ck4p7xq1a000t3ph8v7lpdhzm" class="article-share-link">Share</a>
      
        <a href="https://liangzhenduo0608.github.io/posts/mac-php/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LEMP/">LEMP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MySQL/">MySQL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nginx/">Nginx</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <p>上（shí）班（xí）的时候写PHP都是在开发机上，所以公司配的电脑上一直就没有搭PHP环境。最近我预料到要写一个Web的项目，所以提前搭一下环境备用。</p>
<h1 id="安装MySQL"><a href="#安装MySQL" class="headerlink" title="安装MySQL"></a>安装MySQL</h1><p>可以直接通过homebrew安装：</p>
<pre><code>brew install mysql
</code></pre><p>安装完成后第一次启动MySQL：</p>
<pre><code>brew services start mysql
</code></pre><p>然后就可以用<code>mysql_secure_installation</code>初始化设置一下MySQL，包括root密码等等。</p>
<p>开机启动<code>homebrew.mxcl.mysql.plist</code>已经默认添加到<code>~/Library/LaunchAgents</code>里了，所以不用再设置了。</p>
<h1 id="安装Nginx"><a href="#安装Nginx" class="headerlink" title="安装Nginx"></a>安装Nginx</h1><p>同样Nginx也可以通过homebrew安装：</p>
<pre><code>brew install nginx
</code></pre><p>安装完成后直接用<code>nginx</code>命令就可以启动。</p>
<p>但是Nginx的开机启动项并没有默认添加，我们可以手动将它添加进去：</p>
<pre><code>cp /usr/local/opt/nginx/homebrew.mxcl.nginx.plist ~/Library/LaunchAgents/
</code></pre><h1 id="配置PHP"><a href="#配置PHP" class="headerlink" title="配置PHP"></a>配置PHP</h1><p>macOS默认是安装好PHP的，所以就不想再安装其他版本了。</p>
<p>先编辑<code>/private/etc/php.ini</code>，如果没有就复制一份<code>php.ini.default</code>，然后配置一下时区和数据库socket：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">date.timezone = "Asia/Shanghai"</span><br><span class="line">pdo_mysql.default_socket = /tmp/mysql.sock</span><br></pre></td></tr></table></figure>
<p>因为我要用<strong><del>噫</del>yii</strong>框架，所以改了这一项，如果用到了MySQL的其他函数需要修改相应的<code>mysql.default_socket</code>或<code>mysqli.default_socket</code>。</p>
<p>然后编辑<code>/private/etc/php-fpm.conf</code>，在里面指定一下<code>error_log</code>的路径：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error_log = /usr/<span class="built_in">local</span>/var/<span class="built_in">log</span>/php-fpm/error.log</span><br></pre></td></tr></table></figure>
<p>然后直接用<code>php-fpm</code>命令启动即可。</p>
<p>接着去配置一下<code>/usr/local/etc/nginx/nginx.conf</code>，将php的一段去掉注释，并修改<code>fastcgi_param</code>：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">location</span> <span class="regexp">~ \.php$</span> &#123;</span><br><span class="line">    <span class="attribute">root</span>           html;</span><br><span class="line">    <span class="attribute">fastcgi_pass</span>   <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">    <span class="attribute">fastcgi_index</span>  index.php;</span><br><span class="line">    <span class="attribute">fastcgi_param</span>  SCRIPT_FILENAME  <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">    <span class="attribute">include</span>        fastcgi_params;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后执行<code>nginx -s reload</code>重新加载配置。</p>
<p>然后也可以配置一下php-fpm的开机启动，直接新建<code>~/Library/LaunchAgents/net.php.php-fpm.plist</code>文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>Label<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>net.php.php-fpm<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>RunAtLoad<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>Program<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>/usr/sbin/php-fpm<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>保存后将其权限设为<strong>600</strong>即可，然后执行启动：</p>
<pre><code>launchctl load ~/Library/LaunchAgents/net.php.php-fpm.plist
</code></pre><p>如果提示<code>Service is disabled</code>，上面的命令加上<code>-w</code>参数再执行就行了。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9920928489161252"
     data-ad-slot="3913131990"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



  
    <article id="post-shell-parallel" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
<a href="/posts/shell-parallel/" class="article-date">
  <time datetime="2016-10-10T14:22:22.000Z" itemprop="datePublished">2016-10-10</time>
</a>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/手帐/">手帐</a>►<a class="article-category-link" href="/categories/手帐/实习/">实习</a>
  </div>

  </div>
  <div class="article-inner">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/img/shbanner.png" rel="gallery_ck4p7xq1f00133ph8qgpqbfnb">
        <img src="/img/shbanner.png" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/shell-parallel/">shell脚本内的并发执行</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="https://liangzhenduo0608.github.io/posts/shell-parallel/" data-id="ck4p7xq1f00133ph8qgpqbfnb" class="article-share-link">Share</a>
      
        <a href="https://liangzhenduo0608.github.io/posts/shell-parallel/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/">shell</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <p>之前有一个每周数据统计的工作，需要每周的某一天定时从多台服务器上拉取日志进行汇总生成报表。</p>
<h1 id="顺序执行"><a href="#顺序执行" class="headerlink" title="顺序执行"></a>顺序执行</h1><p>最初的思路是先做一个循环，遍历每台机器并在上面执行相应的数据处理脚本，然后将处理好的数据拉取到汇总的机器上，这样逐台进行，最后进行汇总处理，写出来的脚本是类似这样的：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">array=( \</span><br><span class="line">	<span class="string">"10.144.1.1"</span> \</span><br><span class="line">	<span class="string">"10.144.1.2"</span> \</span><br><span class="line">	<span class="string">"10.144.1.3"</span> \</span><br><span class="line">	<span class="string">"10.144.1.4"</span> \</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$&#123;array[@]&#125;</span></span><br><span class="line"><span class="keyword">do</span>  </span><br><span class="line">	ssh <span class="variable">$i</span> <span class="string">"sh <span class="variable">$log_dir</span>/run.sh"</span></span><br><span class="line">	scp <span class="variable">$i</span>:<span class="variable">$log_dir</span>/<span class="built_in">log</span> <span class="variable">$work_dir</span>/<span class="variable">$i</span>/</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">cat <span class="variable">$work_dir</span>/*/<span class="built_in">log</span> | sort | uniq &gt; <span class="variable">$work_dir</span>/<span class="built_in">log</span></span><br></pre></td></tr></table></figure>
<p>这样写的执行时间大约是<strong>每台机器时间*台数+汇总时间</strong>，虽然不算快，但是凌晨一般也能执行完成。</p>
<h1 id="并发执行"><a href="#并发执行" class="headerlink" title="并发执行"></a>并发执行</h1><p>后来到了国庆假期期间，服务流量骤增，再加上业务改版等一系列原因，导致数据量突然增大，执行时间翻了几倍，任务大概要到下午才能完成，这样一来就会耽误白天的工作。</p>
<p>因为机器数量不少，分机器统计也是主要的时间消耗，因此想到既然几台机器各自的统计互不影响，可以让它们同时进行汇总工作。于是上网找了一下改进方法，改完了大致是这样的：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">array=( \</span><br><span class="line">	<span class="string">"10.144.1.1"</span> \</span><br><span class="line">	<span class="string">"10.144.1.2"</span> \</span><br><span class="line">	<span class="string">"10.144.1.3"</span> \</span><br><span class="line">	<span class="string">"10.144.1.4"</span> \</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$&#123;array[@]&#125;</span></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">	ssh <span class="variable">$i</span> <span class="string">"sh <span class="variable">$log_dir</span>/run.sh"</span></span><br><span class="line">	scp <span class="variable">$i</span>:<span class="variable">$log_dir</span>/<span class="built_in">log</span> <span class="variable">$work_dir</span>/<span class="variable">$i</span>/</span><br><span class="line">&#125;&amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line">cat <span class="variable">$work_dir</span>/*/<span class="built_in">log</span> | sort | uniq &gt; <span class="variable">$work_dir</span>/<span class="built_in">log</span></span><br></pre></td></tr></table></figure>
<p>可以发现主要的改动就在for循环的内容用<code>{}</code>括起来并在末尾加个<code>&amp;</code>，这样就可以实现多次循环一起执行了；另外在<code>done</code>后面加个<code>wait</code>是为了等待所有的循环都执行完成后再做后面的汇总工作，否则一旦有一个循环执行完成就会往下执行了。</p>
<p>这样的执行时间大约是<strong>每台机器时间+汇总时间</strong>，可以看出比最初快了很多。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9920928489161252"
     data-ad-slot="3913131990"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



  
    <article id="post-ssh-conf" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
<a href="/posts/ssh-conf/" class="article-date">
  <time datetime="2016-09-21T14:22:22.000Z" itemprop="datePublished">2016-09-21</time>
</a>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/奇技淫巧/">奇技淫巧</a>►<a class="article-category-link" href="/categories/奇技淫巧/＊nix/">＊nix</a>
  </div>

  </div>
  <div class="article-inner">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/img/sshconfbanner.png" rel="gallery_ck4p7xq1h00163ph8zb12vqi3">
        <img src="/img/sshconfbanner.png" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/ssh-conf/">ssh保持继续连接</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="https://liangzhenduo0608.github.io/posts/ssh-conf/" data-id="ck4p7xq1h00163ph8zb12vqi3" class="article-share-link">Share</a>
      
        <a href="https://liangzhenduo0608.github.io/posts/ssh-conf/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ssh/">ssh</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <p>公司开发登录堡垒机时需要使用<strong>PIN+token</strong>的方式进行认证，而且动态密码只能一次使用，因此一次要打开多个终端都要多次等待动态密码的变化才能登录。</p>
<p>所以听从公司同（xué）事（zhǎng）的建议，配置了一下<code>~/.ssh/config</code>：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Host</span> *</span><br><span class="line">    ControlMaster auto</span><br><span class="line">    ControlPath ~/.ssh/%h-%p-%r</span><br><span class="line">    ControlPersist <span class="literal">yes</span></span><br></pre></td></tr></table></figure>
<p>如果没有这个文件可以新建。其中<code>Host</code>项是指目标地址；<code>ControlMaster</code>一项会使一旦有一个连接以后，再次从其他终端连接同一个host也不必再输密码；<code>ControlPersist</code>一项可以一段时间不再输密码也可以登录。这样配置以后就能实现输一次密码后对于同一host不再输密码即可连接了。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9920928489161252"
     data-ad-slot="3913131990"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/">&lsaquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/">Next &rsaquo;</a>
  </nav>
</section>
          
            <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title">QR code</h3>
  <div class="widget widget-background1">
    <div align="center">
      <img id="qrcode">
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/awesome-qr.js"></script>
<script type="text/javascript">
var img = new Image;

img.src = "/images/icon.png";

setTimeout(function() {
    new AwesomeQRCode().create({
        text: window.location.href,
        size: 160,
        margin: 4,
        colorDark: "#000000",
        colorLight: "#ffffff",
        backgroundImage: img,
        backgroundDimming: 'rgba(0,0,0,0)',
        logoImage: undefined,
        logoScale: 0.2,
        logoMargin: 6,
        logoCornerRadius: 8,
        whiteMargin: true,
        dotScale: 0.4,
        autoColor: true,
        binarize: false,
        binarizeThreshold: 128,
        callback: function(dataURI){},
        bindElement: 'qrcode'
    });
}, 1000);
</script>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ACG/">ACG</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/ACG/Minecraft/">Minecraft</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ACG/艦隊これくしょん/">艦隊これくしょん</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/奇技淫巧/">奇技淫巧</a><span class="category-list-count">16</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/奇技淫巧/Android/">Android</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/奇技淫巧/Windows/">Windows</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/奇技淫巧/macOS/">macOS</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/奇技淫巧/树莓派/">树莓派</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/奇技淫巧/路由器/">路由器</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/奇技淫巧/＊nix/">＊nix</a><span class="category-list-count">5</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手帐/">手帐</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/手帐/实习/">实习</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/手帐/课程/">课程</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/">机器学习</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/论文/">论文</a><span class="category-list-count">4</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络/">网络</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/网络/科学上网/">科学上网</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络/网站部署/">网站部署</a><span class="category-list-count">8</span></li></ul></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/posts/hexo-mathjax/">
              
                <i class="fa-paperclip"></i> 
              
            Hexo博客使用MathJax公式</a>
          </li>
        
          <li>
            <a class="text" href="/posts/ttl/">
              
                <i class="fa-paperclip"></i> 
              
            路由器TTL刷机救砖</a>
          </li>
        
          <li>
            <a class="text" href="/posts/mac-tftp/">
              
                <i class="fa-paperclip"></i> 
              
            macOS启用TFTP服务</a>
          </li>
        
          <li>
            <a class="text" href="/posts/l2tp/">
              
                <i class="fa-paperclip"></i> 
              
            搭建L2TP/IPSec VPN</a>
          </li>
        
          <li>
            <a class="text" href="/posts/certbot/">
              
                <i class="fa-paperclip"></i> 
              
            Let&#39;s Encrypt SSL证书配置</a>
          </li>
        
          <li>
            <a class="text" href="/posts/hexo-deploy/">
              
                <i class="fa-paperclip"></i> 
              
            Hexo博客部署到VPS</a>
          </li>
        
          <li>
            <a class="text" href="/posts/word2vec/">
              
                <i class="fa-paperclip"></i> 
              
            向量空间中词表征的有效估计</a>
          </li>
        
          <li>
            <a class="text" href="/posts/tcp-bbr/">
              
                <i class="fa-paperclip"></i> 
              
            VPS开启TCP-BBR拥塞控制</a>
          </li>
        
          <li>
            <a class="text" href="/posts/sci/">
              
                <i class="fa-paperclip"></i> 
              
            大型属性网络的语义社团识别</a>
          </li>
        
          <li>
            <a class="text" href="/posts/line/">
              
                <i class="fa-paperclip"></i> 
              
            LINE：大规模信息网络嵌入</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <!--%- tagcloud({'amount': '1024', 'orderby': 'name', 'order': '1'}) %-->
      <a href="/tags/VPS/" style="font-size: 21.82px; color: #d1e8ff">VPS</a> <a href="/tags/科学上网/" style="font-size: 20.73px; color: #b9dcff">科学上网</a> <a href="/tags/服务器/" style="font-size: 22.91px; color: #e8f3ff">服务器</a> <a href="/tags/代理/" style="font-size: 17.45px; color: #74b9ff">代理</a> <a href="/tags/Linux/" style="font-size: 24px; color: #fff">Linux</a> <a href="/tags/OpenWrt/" style="font-size: 19.64px; color: #a2d0ff">OpenWrt</a> <a href="/tags/路由器/" style="font-size: 20.73px; color: #b9dcff">路由器</a> <a href="/tags/ShadowSocks/" style="font-size: 16.36px; color: #5daeff">ShadowSocks</a> <a href="/tags/IPv6/" style="font-size: 13.09px; color: #178bff">IPv6</a> <a href="/tags/macOS/" style="font-size: 18.55px; color: #8bc5ff">macOS</a> <a href="/tags/Minecraft/" style="font-size: 13.09px; color: #178bff">Minecraft</a> <a href="/tags/Android/" style="font-size: 13.09px; color: #178bff">Android</a> <a href="/tags/刷机/" style="font-size: 12px; color: #007fff">刷机</a> <a href="/tags/下载/" style="font-size: 12px; color: #007fff">下载</a> <a href="/tags/Unix/" style="font-size: 14.18px; color: #2e96ff">Unix</a> <a href="/tags/LEMP/" style="font-size: 13.09px; color: #178bff">LEMP</a> <a href="/tags/Nginx/" style="font-size: 16.36px; color: #5daeff">Nginx</a> <a href="/tags/MySQL/" style="font-size: 13.09px; color: #178bff">MySQL</a> <a href="/tags/PHP/" style="font-size: 13.09px; color: #178bff">PHP</a> <a href="/tags/SSL/" style="font-size: 13.09px; color: #178bff">SSL</a> <a href="/tags/ChinaDNS/" style="font-size: 12px; color: #007fff">ChinaDNS</a> <a href="/tags/机器学习/" style="font-size: 15.27px; color: #46a2ff">机器学习</a> <a href="/tags/ssh/" style="font-size: 18.55px; color: #8bc5ff">ssh</a> <a href="/tags/GFWlist/" style="font-size: 12px; color: #007fff">GFWlist</a> <a href="/tags/GoAgent/" style="font-size: 12px; color: #007fff">GoAgent</a> <a href="/tags/Git/" style="font-size: 12px; color: #007fff">Git</a> <a href="/tags/JavaScript/" style="font-size: 12px; color: #007fff">JavaScript</a> <a href="/tags/Node-js/" style="font-size: 12px; color: #007fff">Node.js</a> <a href="/tags/舰队Collection/" style="font-size: 13.09px; color: #178bff">舰队Collection</a> <a href="/tags/游戏/" style="font-size: 14.18px; color: #2e96ff">游戏</a> <a href="/tags/VPN/" style="font-size: 13.09px; color: #178bff">VPN</a> <a href="/tags/PandoraBox/" style="font-size: 12px; color: #007fff">PandoraBox</a> <a href="/tags/Qt/" style="font-size: 12px; color: #007fff">Qt</a> <a href="/tags/Windows/" style="font-size: 12px; color: #007fff">Windows</a> <a href="/tags/树莓派/" style="font-size: 12px; color: #007fff">树莓派</a> <a href="/tags/Python/" style="font-size: 12px; color: #007fff">Python</a> <a href="/tags/shell/" style="font-size: 13.09px; color: #178bff">shell</a> <a href="/tags/SoftEther/" style="font-size: 12px; color: #007fff">SoftEther</a> <a href="/tags/Verilog/" style="font-size: 12px; color: #007fff">Verilog</a>
    </div>
  </div>

  
    <div class="widget-wrap">
    <!--h3 class="widget-title">Ad</h3>
    <div class="widget widget-background1" align="center"-->
		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
		<!-- sidebar -->
		<ins class="adsbygoogle"
     		 style="display:block"
     		 data-ad-client="ca-pub-9920928489161252"
     		 data-ad-slot="8654446491"
     		 data-ad-format="auto"
     		 data-full-width-responsive="true"></ins>
		<script>
			(adsbygoogle = window.adsbygoogle || []).push({});
		</script>
    <!--/div-->
</div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget widget-background1">   
      	<ul>
		    <li>
		    	<a href="https://github.com/liangzhenduo0608" target="_blank" title="github.com"><i class="fa-github"></i> GitHub </a>
		    </li>
		      
	        <li>
	        	<a href="https://liangzhenduo0608.github.io" target="_blank" title="liangzhenduo0608.github.io"><i class="fa-github-square"></i> Mirror Site </a>
	        </li>
	          
	        <li>
	        	<a href="https://blog.mahoucoder.com/" target="_blank" title="blog.mahoucoder.com"><i class="fa-h-square"></i> 魔法コーダ </a>
	        </li>

			<li>
	        	<a href="https://blog.hackroid.com/" target="_blank" title="blog.hackroid.com"><i class="fa-h-square"></i> Hackroid </a>
	        </li>

		    <li>
		    	<a href="http://xzjqx.me/" target="_blank" title="xzjqx.me"><i class="fa-h-square"></i> 笑卒见清晰 </a>
		    </li>

	        <li>
	        	<a href="http://muyus.cc/" target="_blank" title="muyus.cc"><i class="fa-wordpress"></i> 暮雨今夕 </a>
	        </li>

	        <li>
	        	<a href="http://zhenlee.cn/" target="_blank" title="zhenlee.cn"><i class="fa-wordpress"></i> Fantasia </a>
	        </li>

	        <li>
	        	<a href="https://steinslab.xyz/" target="_blank" title="steinslab.xyz"><i class="fa-wordpress"></i> SPtuan </a>
	        </li>

	        <li>
	        	<a href="https://qyetfu.site/" target="_blank" title="qyetfu.site"><i class="fa-reorder"></i> Qyetfu </a>
	        </li>
    	</ul>
    </div>
</div>

</script>
  
    <div class="widget-wrap">
    <h3 class="widget-title">Statistics</h3>
    <div class="widget widget-background1" align="center">
    	<!--a href="https://clustrmaps.com/site/19kh7" title="Visit tracker"><img src="//clustrmaps.com/map_v2.png?cl=eeeeee&w=220&t=n&d=3kNIfPXlC9a4s7N8RRFV04RgWWonJP-1hQ4Drq_rVj8&co=3d3d3b&ct=eeeeee" /></a-->
    	<script type="text/javascript" src="//rf.revolvermaps.com/0/0/2.js?i=5gpp8v00aap&amp;m=8&amp;s=178&amp;c=fff600&amp;t=1" async="async"></script>
      	<a href="https://s05.flagcounter.com/more/779"><img src="https://s05.flagcounter.com/count2/779/bg_3D3D3B/txt_FFFFFF/border_3D3D3B/columns_2/maxflags_100/viewers_0/labels_1/pageviews_1/flags_0/percent_1/" alt="shintaku.xyz" border="0"></a>
    </div>
</div>
  
    <div class="widget-wrap">
    <h3 class="widget-title">Reward</h3>
    <div class="widget widget-background1" align="center">
      	<img src="/images/alipay.png" alt="支付宝支付" width="220">
      	<img src="/images/wechat.png" alt="微信支付" width="220">
      	<a href="https://www.paypal.me/liangzhenduo" title="PayPal支付" onclick="javascript:window.open('https://www.paypal.me/liangzhenduo','WIPaypal','toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=yes, width=1060, height=700'); return false;"><img src="https://www.paypalobjects.com/webstatic/mktg/logo/bdg_now_accepting_pp_2line_w.png" alt="PayPal支付" width="220"/></a>
    </div>
</div>
  
    <div id="ukagaka_panel"></div>
<script src="/js/jquery-ui.min.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/ukagaka.js"></script>
<script type="text/javascript">$('#ukagaka_panel').ukagaka();</script>

  
</aside>


          
        
      </div>
      <footer id="footer">
  

  <div class="outer" align="center">
    <div id="wechat" style="display: none">
      <img src="/images/mmqrcode.png" width="220" height="220">
    </div>
    <div class="social-group">
      
      <a href="https://github.com/liangzhenduo0608" target="_blank" title="GitHub"><i class="fa-github"></i></a>
      
      
      <a href="https://plus.google.com/114761524022260759157" target="_blank" title="Google+"><i class="fa-google-plus-official"></i></a>
      
      
      <a href="https://www.facebook.com/100005630052910" target="_blank" title="Facebook"><i class="fa-facebook-official"></i></a>
      
      
      <a href="https://twitter.com/liangzhenduo" target="_blank" title="Twitter" ><i class="fa-twitter"></i></a>
      
      
      <a href="https://www.linkedin.com/in/zhenduo-liang-795110131" target="_blank" title="LinkedIn"><i class="fa-linkedin"></i></a>
      
      <a href="/images/mmqrcode.png" title="WeChat" class="fancybox"><i class="fa-weixin"></i></a>
      
      <a href="https://weibo.com/378950608" target="_blank" title="Weibo" ><i class="fa-weibo"></i></a>
      
      
      <a href="mailto:liangzhenduo0608@hotmail.com" target="_blank" title="Email" ><i class="fa-envelope-o"></i></a>
      
    </div>
    <div id="footer-info" class="inner" align="center">
      Powered by <a href="https:\/\/hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https:\/\/github.com/hexojs/hexo-theme-landscape" target="_blank" title="landscape">landscape</a>     &copy; 2019 Shintaku
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/gallery" class="mobile-nav-link">Gallery</a>
  
</nav>
    
<script>
  var disqus_shortname = 'shintaku';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>




  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>
<script src="/js/script.js"></script>

  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</body>
</html>